---
title: "Volcans"
author: "Agathe & Romane"
output: 
  flexdashboard::flex_dashboard:
    theme:
      version: 4
      bg: "#FFFFCC" # couleur du texte des onglets
      fg: "#330000" # couleur du texte dans les cadres
      primary: "green"
      navbar-bg: "darkorange" # couleur de la banière du haut
    orientation: columns
    vertical_layout: fill
params:
  setup_path: ../resources/
---

<style>                     
.navbar {
background-color:#FFFFCC;
border-color:#FFFFCC;
}
.navbar-brand {
color:black!important;
}


</style>   


```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(ggplot2)
library(reshape2)
library(plotly)
library(rnaturalearth)
library(cowplot)
library(readr)
library(fmsb)
library(mapproj)
```

```{r}
data <- read_delim("volcano.csv",
                   delim = ";", 
                   escape_double = FALSE,
                   trim_ws = TRUE)
#summary(data)
dataquanti <- data[,c(1,7:9,13,15:19)]

#names(data)
data$Year <- as.factor(data$Year)
data$Name <- as.factor(data$Name)
data$Location <- as.factor(data$Location)
data$Country <- as.factor(data$Country)
```


Présentation générale
=======================================================================

Column {data-width=650}
-----------------------------------------------------------------------

### Présentation de la problématique

Oui bonjour c'est nous les employés de chez "Goodenough Assurance" j'espère que vous allez bien.

### Présentation des données

Nos données c'est sur les volcans et on cherche à assurer nos clients en cas de sinistre parce que franchement se faire ravager la maison par de la lave c'est pas fun.

Graphique 1
=======================================================================


```{r}
freq <- as.data.frame(table(data$Continent))
freq <- pivot_wider(data = freq,names_from = Var1, values_from = Freq)
freq <- freq[1,]
#colnames(freq)
maxmin <- data.frame("Afrique du Nord" = c(35,0), "Afrique subsaharienne" = c(35,0), "Amerique du Nord" = c(35,0), "Amerique latine" = c(35,0), "Asie de l'Est" = c(35,0), "Asie du Sud" = c(35,0), "Europe" = c(35,0),check.names=FALSE)
rownames(maxmin) <- c("Max", "Min")
freqradar <- rbind(maxmin, freq)
radarchart(freqradar,maxmin = TRUE, #custom polygon
           pcol=rgb(1,0.140,0,0.9) , pfcol=rgb(1,0.140,0,0.5) , plwd=4 , plty=1,
           
           #custom the grid
           cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,35,7), cglwd=1, title = "Nombre d'éruptions par continents de 2010 à 2018",
           
           #custom labels
           vlcex=0.9 )
```

Graphique 2
=======================================================================

```{r}
try <- map_data('world')

ggplot() +
  geom_polygon(data = try,
               aes(x = long, y = lat, group = group),
               fill = 'grey') +
  geom_point(data = data %>% arrange(TOTAL_COST),
             aes(x = Longitude,
                 y = Latitude,
                 color = DAMAGE_MILLIONS_DOLLARS,
                 size = TOTAL_LIFE_COST),
             alpha = 0.8) +
  scale_color_gradientn(colors = c('#FF6600',
                                   '#330000'),
                        name = 'Coûts humain',
                        n.breaks = 4) +
  scale_size(name = 'Coûts des dégats matériels') +
  coord_map('mercator',
            xlim = c(-180,180),
            ylim = c(-50,70)) +
  theme_map() +
  theme(legend.position = 'bottom',
        legend.box = 'vertical') +
  labs(title = 'Coût des éruptions dans le monde',
       subtitle = 'Coûts matériels et humains') +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5))
```




